{% extends 'base.html' %}

{% block content %}

<!-- MAIN CONTENT -->
<div class="main-content">

   <!-- HEADER -->
   <div class="header bg-dark pb-5">
      <div class="container-fluid">

         <!-- Body -->
         <div class="header-body">
            <div class="row align-items-end">
               <div class="col">
                  <h6 class="header-pretitle text-secondary">
                     Anual
                  </h6>
                  <h1 class="header-title text-white">
                     Contabil
                  </h1>
               </div>

               <div class="col-auto">
                  <ul class="nav nav-tabs header-tabs">
                     <li class="nav-item" data-toggle="chart" data-target="#anualDebits" data-trigger="click"
                        data-action="toggle" data-dataset="0">
                        <a href="#" class="nav-link text-center active" data-bs-toggle="tab">
                           <h6 class="header-pretitle text-secondary">
                              Entradas
                           </h6>
                           <h3 class="text-white mb-0">
                              {{ finance_data['ins'] }}
                           </h3>
                        </a>
                     </li>
                     <li class="nav-item" data-toggle="chart" data-target="#anualDebits" data-trigger="click"
                        data-action="toggle" data-dataset="1">
                        <a href="#" class="nav-link text-center" data-bs-toggle="tab">
                           <h6 class="header-pretitle text-secondary">
                              Saídas
                           </h6>
                           <h3 class="text-white mb-0">
                              {{ finance_data['outs'] }}
                           </h3>
                        </a>
                     </li>
                     <li class="nav-item" data-toggle="chart" data-target="#anualDebits" data-trigger="click"
                        data-action="toggle" data-dataset="2">
                        <a href="#" class="nav-link text-center" data-bs-toggle="tab">
                           <h6 class="header-pretitle text-secondary">
                              Balanço
                           </h6>
                           <h3 class="text-white mb-0">
                              {{ finance_data['bal_percent'] }}%
                           </h3>
                        </a>
                     </li>
                  </ul>
               </div>
            </div>
         </div>

         <!-- Footer -->
         <div class="header-footer">

            <!-- Chart -->
            <div class="chart">
               <canvas id="anualDebits" class="chart-canvas"></canvas>
            </div>
         </div>
      </div>
   </div>

   <!-- CARDS -->
   <div class="container-fluid mt-n6">
      <div class="row">
         <div class="col-12 col-xl-8">
            <!-- Débitos - Mes -->
            <div class="card">
               <div class="card-header">
                  <h4 class="card-header-title">
                     Débitos - Mês
                  </h4>
                  <span class="text-muted me-3">
                     Show affiliate:
                  </span>

                  <!-- Switch -->
                  <div class="form-check form-switch">
                     <input class="form-check-input" type="checkbox" id="cardToggle" data-toggle="chart"
                        data-target="#ordersChart" data-trigger="change" data-action="add" data-dataset="1" />
                     <label class="form-check-label" for="cardToggle"></label>
                  </div>
               </div>
               <div class="card-body">
                  <!-- Chart -->
                  <div class="chart">
                     <canvas id="month-debits" class="chart-canvas"
                        data-debits="{{finance_data['month_debits']}}"></canvas>
                  </div>
               </div>
            </div>
         </div>

         <div class="col-12 col-xl-4">
            <!-- Débitos - Percentual -->
            <div class="card">
               <div class="card-header">

                  <!-- Title -->
                  <h4 class="card-header-title">
                     Débitos - Percentual
                  </h4>

                  <!-- Tabs -->
                  <ul class="nav nav-tabs nav-tabs-sm card-header-tabs">
                     <li class="nav-item" data-toggle="chart" data-target="#trafficChart" data-trigger="click"
                        data-action="toggle" data-dataset="0">
                        <a href="#" class="nav-link active" data-bs-toggle="tab">
                           All
                        </a>
                     </li>
                     <li class="nav-item" data-toggle="chart" data-target="#trafficChart" data-trigger="click"
                        data-action="toggle" data-dataset="1">
                        <a href="#" class="nav-link" data-bs-toggle="tab">
                           Direct
                        </a>
                     </li>
                  </ul>

               </div>
               <div class="card-body">

                  <!-- Chart -->
                  <div class="chart chart-appended">
                     <canvas id="debitsChart" class="chart-canvas" data-toggle="legend" data-target="#debitsChartLegend"
                        data-debits-category="{{finance_data['invoice_amount']}}"></canvas>
                  </div>

                  <!-- Legend -->
                  <div id="debitsChartLegend" class="chart-legend"></div>

               </div>
            </div>
         </div>
      </div>

      <!-- CARDS -->
      <div class="row">
         <div class="col-12 col-lg-6 col-xl">

            <!-- Crédito -->
            <div class="card">
               <div class="card-body">
                  <div class="row align-items-center gx-0">
                     <div class="col">

                        <!-- Title -->
                        <h6 class="text-uppercase text-muted mb-2">
                           Crédito
                        </h6>

                        <!-- Heading -->
                        <span class="h2 mb-0">
                           R$ {{finance_data['credit_amount']}}
                        </span>

                        <!-- Badge -->
                        <span class="badge bg-success-soft mt-n1">
                           +3.5%
                        </span>

                     </div>
                     <div class="col-auto">

                        <!-- Icon -->
                        <span class="h2 fe fe-dollar-sign text-muted mb-0"></span>

                     </div>
                  </div> <!-- / .row -->
               </div>
            </div>

         </div>
         <div class="col-12 col-lg-6 col-xl">

            <!-- Total Débitos -->
            <div class="card">
               <div class="card-body">
                  <div class="row align-items-center gx-0">
                     <div class="col">

                        <!-- Title -->
                        <h6 class="text-uppercase text-muted mb-2">
                           Total Débitos
                        </h6>

                        <!-- Heading -->
                        <span class="h2 mb-0">
                           R$ {{finance_data['debit_amount']}}
                        </span>

                     </div>
                     <div class="col-auto">

                        <!-- Icon -->
                        <span class="h2 fe fe-briefcase text-muted mb-0"></span>

                     </div>
                  </div> <!-- / .row -->
               </div>
            </div>

         </div>
         <div class="col-12 col-lg-6 col-xl">

            <!-- Conversion Rate -->
            <div class="card">
               <div class="card-body">
                  <div class="row align-items-center gx-0">
                     <div class="col">

                        <!-- Title -->
                        <h6 class="text-uppercase text-muted mb-2">
                           Conversion Rate
                        </h6>

                        <div class="row align-items-center g-0">
                           <div class="col-auto">

                              <!-- Heading -->
                              <span class="h2 me-2 mb-0">
                                 84.5%
                              </span>

                           </div>
                           <div class="col">

                              <!-- Progress -->
                              <div class="progress progress-sm me-4">
                                 <div class="progress-bar" role="progressbar" style="width: 85%" aria-valuenow="85"
                                    aria-valuemin="0" aria-valuemax="100"></div>
                              </div>

                           </div>
                        </div> <!-- / .row -->
                     </div>
                     <div class="col-auto">

                        <!-- Icon -->
                        <span class="h2 fe fe-clipboard text-muted mb-0"></span>

                     </div>
                  </div> <!-- / .row -->
               </div>
            </div>

         </div>
         <div class="col-12 col-lg-6 col-xl">

            <!-- Balanço -->
            <div class="card">
               <div class="card-body">
                  <div class="row align-items-center gx-0">
                     <div class="col">

                        <!-- Title -->
                        <h6 class="text-uppercase text-muted mb-2">
                           Balanço
                        </h6>

                        <!-- Heading -->
                        <span class="h2 mb-0">
                           R$ {{finance_data['balance_amount']}}
                        </span>

                     </div>
                     <div class="col-auto">

                        <!-- Chart -->
                        <div class="chart chart-sparkline">
                           <canvas class="chart-canvas" id="sparklineChart"></canvas>
                        </div>

                     </div>
                  </div> <!-- / .row -->
               </div>
            </div>

         </div>
      </div>

      <div class="row">
         <!-- Activity -->
         <div class="col-12 col-xl-4">
            <div class="card-adjust-xl">
               <div class="card">
                  <div class="card-header">
                     <div class="row">
                        <div class="col">
                           <h4 class="card-header-title">
                              Extrato Crédito
                           </h4>
                        </div>
                        <div class="col-auto me-n3">
                           <a class="small" href="#!">Exibir Tudo</a>
                        </div>
                        <div class="col-auto">
                           <a href="#!" class="btn btn-sm btn-white" data-bs-toggle="modal"
                              data-bs-target="#modalCreditMonth">
                              Set Month
                           </a>
                        </div>
                     </div>
                  </div>
                  <div class="card-body">
                     <div class="list-group list-group-flush list-group-activity my-n3">
                        {% for item in finance_data['list_credits'] %}
                        <div class="list-group-item">
                           <div class="row">
                              <div class="col-auto">
                                 <!-- Avatar -->
                                 <div class="avatar avatar-sm">
                                    <img src="../static/img/avatars/profiles/avatar-1.jpg" alt="..."
                                       class="avatar-img rounded-circle" />
                                 </div>
                              </div>

                              <div class="col ms-n2">
                                 <!-- Content -->
                                 <div class="small">
                                    <strong>{{ item.description }}</strong>
                                    R$ {{ item.amount }}
                                    <span class="badge bg-primary-soft">{{item.operation}}</span>

                                    {% if item.category == 'Fixo' %}
                                    <span class="badge bg-success-soft">{{item.category}}</span>
                                    {% elif item.category == 'Variavel' %}
                                    <span class="badge bg-warning-soft">{{item.category}}</span>
                                    {% else %}
                                    <span class="badge bg-secondary-soft">{{item.category}}</span>
                                    {% endif %}
                                 </div>

                                 <!-- Time -->
                                 <small class="text-muted">
                                    {{ item.date_register }}
                                 </small>
                              </div>
                           </div> <!-- / .row -->
                        </div>
                        {% endfor %}
                     </div>
                  </div>
               </div>
            </div>
         </div>

         <!-- Table Débitos -->
         <div class="col-12 col-xl-8">
            <div class="card"
               data-list='{"valueNames": ["description", "operation", "amount", "date_register"], "page": 5, "pagination": {"paginationClass": "list-pagination"}}'
               id="contactsList">
               <div class="card-header">
                  <div class="row">
                     <div class="col">
                        <h4 class="card-header-title">
                           Extrato
                        </h4>
                     </div>
                     <div class="col-auto me-n3">
                        <!-- Select -->
                        <form>
                           <select class="form-select form-select-sm form-control-flush"
                              data-choices='{"searchEnabled": false}'>
                              <option>5 per page</option>
                              <option selected>10 per page</option>
                              <option>All</option>
                           </select>
                        </form>
                     </div>
                     <div class="col-auto">
                        <a href="#!" class="btn btn-sm btn-white">
                           Exportar
                        </a>
                     </div>
                  </div>

               </div>

               <div class="table-responsive mb-0">
                  <table class="table table-sm table-nowrap table-hover card-table">
                     <thead>
                        <tr>
                           <th>
                              <a href="#" class="text-muted list-sort" data-sort="description">
                                 Descrição
                              </a>
                           </th>
                           <th>
                              <a href="#" class="text-muted list-sort" data-sort="operation">
                                 Operação
                              </a>
                           </th>
                           <th>
                              <a href="#" class="text-muted list-sort" data-sort="amount">
                                 Valor
                              </a>
                           </th>
                           <th colspan="2">
                              <a href="#" class="text-muted list-sort" data-sort="date_register">
                                 Data
                              </a>
                           </th>
                        </tr>
                     </thead>
                     <tbody class="list">
                        {% for item in finance_data['list_debits'] %}
                        <tr>
                           <td class="description">
                              <div class="d-flex align-items-center">

                                 <!-- Image -->
                                 <div class="avatar">
                                    <img class="avatar-img rounded me-3"
                                       src="../static/img/avatars/products/{{item.category}}.jpg" alt="..." />
                                 </div>

                                 <div class="ms-3">
                                    <h4 class="fw-normal mb-1">{{item.description}}</h4>
                                    <small class="text-muted">{{item.category}}</small>

                                 </div>
                              </div>
                           </td>
                           <td class="operation">
                              <span class="badge bg-danger-soft">{{item.operation}}</span>
                           </td>
                           <td class="amount">
                              R$ {{item.amount}}
                           </td>
                           <td class="date_register">
                              {{item.date_register}}
                           </td>
                           <td class="text-end">

                              <!-- Dropdown -->
                              <div class="dropdown">
                                 <a href="#" class="dropdown-ellipses dropdown-toggle" role="button"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fe fe-more-vertical"></i>
                                 </a>
                                 <div class="dropdown-menu dropdown-menu-end">
                                    <a href="#!" class="dropdown-item">
                                       Atualizar
                                    </a>
                                    <a href="#!" class="dropdown-item">
                                       Apagar
                                    </a>
                                 </div>
                              </div>

                           </td>
                        </tr>
                        {% endfor %}
                     </tbody>
                  </table>
               </div>

               <div class="card-footer d-flex justify-content-between">

                  <!-- Pagination (prev) -->
                  <ul class="list-pagination-prev pagination pagination-tabs card-pagination">
                     <li class="page-item">
                        <a class="page-link ps-0 pe-4 border-end" href="#">
                           <i class="fe fe-arrow-left me-1"></i> Prev
                        </a>
                     </li>
                  </ul>

                  <!-- Pagination -->
                  <ul class="list-pagination pagination pagination-tabs card-pagination"></ul>

                  <!-- Pagination (next) -->
                  <ul class="list-pagination-next pagination pagination-tabs card-pagination">
                     <li class="page-item">
                        <a class="page-link ps-4 pe-0 border-start" href="#">
                           Next <i class="fe fe-arrow-right ms-1"></i>
                        </a>
                     </li>
                  </ul>
               </div>
            </div>

         </div>
      </div>
   </div>

</div>

<!-- Modal: Members -->
<div class="modal fade" id="modalCreditMonth" tabindex="-1" role="dialog" aria-hidden="true">
   <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
         <div class="modal-card card">
            <div class="card-header">

               <!-- Title -->
               <h4 class="card-header-title" id="exampleModalCenterTitle">
                  Set Sum Credit Month
               </h4>

               <!-- Close -->
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

            </div>

            <div class="card-body">

               <form action="dashboard/sum-credit-month" method="post">
                  <div class="form-group">
                     <label class="form-label">
                        Mês Referência
                     </label>
                     <div class="input-group input-group-flush input-group-merge input-group-reverse">
                        <input name="month" class="form-control list-search" type="number" placeholder="Mês Referência">
                        <div class="input-group-text">
                           <span class="fe fe-search"></span>
                        </div>
                     </div>
                  </div>

                  <div class="form-group">
                     <label class="form-label">
                        Ano Referência
                     </label>
                     <div class="input-group input-group-flush input-group-merge input-group-reverse">
                        <input name="year" class="form-control list-search" type="number" placeholder="Ano Referência">
                        <div class="input-group-text">
                           <span class="fe fe-search"></span>
                        </div>
                     </div>
                  </div>

                  <!-- Buttons -->
                  <div class="row">
                     <div class="col-12 col-md-6">
                        <a href="#" class="btn w-100 btn-link text-muted mt-2">
                           Cancelar
                        </a>
                     </div>

                     <div class="col-12 col-md-6">
                        <button type="submit" class="btn w-100 btn-primary">
                           Salvar
                        </button>
                     </div>
                  </div>
               </form>

            </div>
         </div>
      </div>
   </div>
</div>

{% endblock %}